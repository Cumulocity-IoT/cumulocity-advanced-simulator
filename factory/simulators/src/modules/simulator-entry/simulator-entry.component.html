<c8y-title>Simulators</c8y-title>

<div class="card-group">
  <a
    class="card add-card clickable custom-card"
    (click)="openAddNewSimulatorDialog()"
    ><i c8yicon="plus-square" class="fa fw fa-plus-square"></i><br />
    Add Simulator
  </a>
  <ng-container *ngFor="let simulator of allSimulators">
    <div>
      <div class="card custom-card">
        <div
          class="card-header separator"
          style="justify-content: space-between; height: 56px"
        >
          <div class="card-title">
            <h4 class="c8y-icon-duocolor c8y-icon-simulator c8y-icon">
              &nbsp;{{ simulator.c8y_DeviceSimulator?.name }}
            </h4>
          </div>
          <div class="dropdown settings" style="float: right" dropdown>
            <button
              type="button"
              title="Actions"
              dropdownToggle
              class="dropdown-toggle c8y-dropdown"
            >
              <i c8yIcon="ellipsis-v" class="fa fw fa-ellipsis-v"></i>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" *dropdownMenu>
              <li>
                <button type="button" (click)="editSimulator(simulator)">
                  <i c8yIcon="edit"></i> Edit Simulator
                </button>
              </li>
              <li>
                <button type="button" (click)="onDuplicateSelected(simulator)">
                  <i c8yIcon="copy"></i> Create copy of simulator
                </button>
              </li>
              <li>
                <button type="button" (click)="onDeleteSelected(simulator)">
                  <i c8yIcon="trash"></i> Remove from list
                </button>
              </li>
            </ul>
          </div>
        </div>
        <div class="card-block">
          <div style="display: flex; justify-content: space-between">
            <label class="c8y-switch">
              <input
                type="checkbox"
                [ngModel]="simulator.c8y_DeviceSimulator.state === 'RUNNING'"
                (ngModelChange)="onStateChange(simulator)"
              />
              <span></span
              ><em> {{ simulator.c8y_DeviceSimulator.state | lowercase }}</em>
            </label>
            <div triggers="hover"
            [popover] = "popStats"
            placement="auto"
            #pop="bs-popover">
              <ng-container *ngIf="!simulator.c8y_DeviceSimulator.commandQueue.length">
                &nbsp;<i
                  c8yIcon="sort-amount-asc"
                  style="color: #b0b9bf"
                ></i
                >&nbsp;
                {{
                  simulator.c8y_DeviceSimulator.commandQueue.length
                }}
              </ng-container>
              <ng-container *ngFor="let item of instructionTypes">
                &nbsp;<i
                  [c8yIcon]="item.category.icon"
                  *ngIf="
                    (simulator.c8y_DeviceSimulator.commandQueue
                      | instructionType)[item.category.type]
                  "
                  style="color: #b0b9bf"
                ></i
                >&nbsp;
                {{
                  (simulator.c8y_DeviceSimulator.commandQueue
                    | instructionType)[item.category.type]
                    ? (simulator.c8y_DeviceSimulator.commandQueue
                        | instructionType)[item.category.type]
                    : ""
                }}<ng-container *ngIf="item.category.break"
                  ><br
                /></ng-container>
              </ng-container>
              
            </div>
          </div>
        </div>
      </div>
    </div>
  


<ng-template #popStats>
  <em>Total Instructions: {{simulator.c8y_DeviceSimulator.commandQueue.length}}</em>
  <table class="table table-striped">
    
    <thead>
      <tr>
        <th>Category</th>
        <th>Count</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of instructionTypes">
        <td><i [c8yIcon]="item.category.icon" style="color: #b0b9bf"></i>&nbsp;<span>{{item.category.type}}</span></td>
        <td>{{(simulator.c8y_DeviceSimulator.commandQueue | instructionType)[item.category.type]}}</td>
      </tr>

    </tbody>
  </table>
</ng-template>

</ng-container>
</div>