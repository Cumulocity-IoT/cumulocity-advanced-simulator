<div class="card" [style.background]="selectedColor">
  <div class="card-block">
    <ng-container *ngTemplateOutlet="header; context: templateCtx">
    </ng-container>
    <br>
    
    <div *ngIf="isExpanded">
      <label class="c8y-switch">
        <input type="checkbox"  [ngModel]="isSmartRestSelected" (ngModelChange)="isSmartRestSelected=!isSmartRestSelected"/>
        <span></span><em> Select from SmartREST Templates </em>
      </label>
      <div class="row">
        <div class="col-md-12">
          <div class="form-group form-group-md">
            <div class="c8y-select-wrapper" *ngIf="!isSmartRestSelected">
              <br />
              <select
                class="form-control"
                [(ngModel)]="selectedConfig"
                (ngModelChange)="onChangeConfig($event)"
              >
                <option *ngFor="let first of defaultConfig">{{ first }}</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      
      <div [ngSwitch]="selectedConfig" *ngIf="!isSmartRestSelected">
        <ng-template
          *ngFor="let form of allForms; let i = index"
          [ngSwitchCase]="defaultConfig[i]"
        > 
          <div class="row">
            <div class="col-xs-4" *ngFor="let entry of form">
              <div class="form-group">
                <label>{{ entry.label }}</label>
                <div
                  class="form-group form-group-md"
                  *ngIf="entry.type === 'select'"
                >
                  <div class="c8y-select-wrapper">
                    <select
                      class="form-control"
                      [(ngModel)]="instructionValue[entry.name]"
                    >
                      <option
                        *ngFor="let category of entry.category"
                        [value]="category.code"
                      >
                        {{ category.name }}
                      </option>
                    </select>
                  </div>
                </div>
                <input
                  *ngIf="entry.type === 'textField'"
                  id="{{ entry.name }}"
                  [required]="entry.required"
                  class="form-control"
                  [(ngModel)]="instructionValue[entry.name]"
                  placeholder="{{ entry.placeholder }} {{
                    entry.required ? '(required)' : '(optional)'
                  }}"
                />
              </div>
            </div>
            <div class="col-xs-12">
              <button
                class="btn {{ selectedSeries ? 'btn-default' : 'btn-success' }}"
                (click)="updateSeries(defaultConfig[i])"
                style="float: right"
              >
                {{ selectedSeries ? "Update" : "Add" }} {{ defaultConfig[i] }}
              </button>
              <select
                class="form-control"
                style="max-width: 200px; margin-right: 20px; float: right"
                [(ngModel)]="selectedColor"
              >
                <option
                  *ngFor="let entry of reducedColors"
                  [style.background]="entry"
                >
                  {{ entry }}
                </option>
              </select>
            </div>
          </div>
        </ng-template>
      </div>

      <div *ngIf="isSmartRestSelected">
      <select class="selectpicker" [(ngModel)]="smartRestSelectedConfig">
        <option *ngFor="let first of smartRestConfig" [ngValue]="first">{{first.msgId}}&nbsp;{{ first.name }}</option>
      </select>
      <br>
      <ng-container *ngIf="smartRestSelectedConfig">
        <div *ngFor="let entry of smartRestSelectedConfig.customValues">
          <label>{{ entry.path }}</label>
          <input
            id="{{ entry.path }}"
            [required]="true"
            
            class="form-control"
            placeholder="(required)"
          />
        </div>
      </ng-container>
    </div>
    </div>
  </div>
</div>
