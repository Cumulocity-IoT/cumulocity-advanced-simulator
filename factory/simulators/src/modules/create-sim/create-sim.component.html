<c8y-title>
  <span *ngIf="!editMode">{{simulatorTitle}}</span>
  <input *ngIf="editMode" [(ngModel)]="simulatorTitle"  (focusout)="editSimulatorTitle()">&nbsp;&nbsp;
  <i c8yIcon="edit" style="font-size: small;" (click)="editMode=true"></i>
</c8y-title>
<c8y-action-bar-item [placement]="'right'" [itemClass]="'btn'">
  <button class="btn btn-primary" (click)="createSinusWave()">Sinus Wave</button>
</c8y-action-bar-item>
  <c8y-action-bar-item [placement]="'left'" [itemClass]="'btn'">
    <button class="transparent" style="font-size: 1.5em;" (click)="changeRouteLastSite()"><i c8yIcon="arrow-circle-left"></i></button>
  </c8y-action-bar-item>
<div class="row main-div" style="resize: vertical;overflow: auto;height: 70vh;">
  <!--
  <c8y-action-bar-item [placement]="'right'"  *ngif="false" [itemClass]="'btn-group'">
    <div class="btn-group" role="group" *ngFor="let item of actionButtons">
      <button
        type="button"
        [ngClass]="
          currentSelection === item ? 'btn btn-primary' : 'btn btn-default'
        "
        (click)="selectButton(item)"
      >
        {{ item }}
      </button>
    </div>
  </c8y-action-bar-item>-->
  <div class="col-lg-8" style="height:100%;">
<!--
    <div class="tight-grid">
      <div class="col-xs-6">
        <button class="btn-add-block" (click)="viewNewSeries = !viewNewSeries">
          <i c8yIcon="sort-amount-asc"></i> Add New Series
        </button>
      </div>
      <div class="col-xs-6">
        <button class="btn-add-block" (click)="viewHistoricalSeries = !viewHistoricalSeries">
          <i c8yIcon="history"></i> Choose from existing 
        </button>
      </div>
    </div>
    -->

    <div >
      <app-sim-settings
        [mo]="mo"
        [header]="addseries"
        [commandQueue]="commandQueue"
        [isExpanded]="true"
        [smartRestConfig]="smartRestConfig"
        (allSeriesEmitter)="updateAllSeries($event)"
      ></app-sim-settings>

      
      <div class="card page-sticky-header" style="display: flex; justify-content: space-between;">
        <div style="display: flex; float: left;  padding: 5px; margin: 5px">
        <i c8yIcon="server" style="font-size: larger;"></i>
        &nbsp;&nbsp;<h4>Series</h4>
      </div>
      <div class="filter">
      <div id="filter" class="input-group input-group-search" style="padding: 5px" >
        <input
          type="search"
          class="form-control"
          placeholder="Filterâ€¦"
          [(ngModel)]="searchString"
        />
        <span class="input-group-addon">
          <i c8yIcon="filter" *ngIf="!searchString || searchString.length === 0"></i>
          <i
            c8yIcon="times"
            class="text-muted"
            *ngIf="searchString && searchString.length > 0"
            (click)="data.searchString = ''"
          ></i>
        </span>
      </div>
      </div>
    </div>
    <div class="settings">
      <ng-container>
        <div style="height: 500px;">
        <div *ngFor="let first of allInstructionsSeries; let i = index" >
          <!-- <app-sim-settings
            [id]="'app-sim-settings_'+ i | toString"
            [mo]="mo"
            [header]="addedSeries"
            [series]="first"
            [commandQueue]="commandQueue"
            [smartRestConfig]="smartRestConfig"
            [isExpanded]="first.active"
          ></app-sim-settings> -->
          <app-series-item [series]="first" [index]="i" [allInstructionsSeries]="allInstructionsSeries"
          [commandQueue]="commandQueue"></app-series-item>
        </div>
      </div>
      </ng-container>
    </div>
  </div>

    <div *ngIf="false" class="col-sm-8">
      <br />
      <button
        class="btn btn-success"
        style="float: right; top: 0; z-index: 2; position: sticky"
      >
        Generate Instructions
      </button>
    </div>
  </div>

  <div class="col-lg-4" style="height:100%;">
    <app-show-instruction
      [mo]="mo"
      (getInvalidSimulator)="getCurrentSimulatorState($event)"
      (currentValue)="getCurrentValue($event)"
      (currentViewState)="updateViewState($event)"
    ></app-show-instruction>
  </div>
</div>

<div class="row" *ngIf="this.commandQueue.length && !this.invalidSimulator">
  <h1>Overview and Estimations</h1>
  <div class="col-xs-6">
    <h3>Just one Cycle</h3>
    <app-simulator-chart></app-simulator-chart>
  </div>
  <div class="col-xs-6">
    <h3>Multiple Runthroughs</h3>
    <app-simulator-chart [numberOfRuns]="3"></app-simulator-chart>
  </div>
</div>

<div class="row" style="margin-bottom:150px;" *ngIf="this.commandQueue.length && !this.invalidSimulator">
  <div class="col-xs-12">
    <app-command-queue-statistics></app-command-queue-statistics>
  </div>
</div>


<ng-template #addedSeries let-item="item">
    <button class="transparent" aria-controls="collapseBasic" (click)="item.active = !item.active"
    [attr.aria-expanded]="item.active"><i c8yIcon="caret-down"></i>
    </button>
    <ng-container *ngIf="item.type === 'Measurement'"
      ><h4>Measurement Series</h4>
    </ng-container
    >

    <ng-container *ngIf="item.alarmText && item.alarmType">
      <h4>Alarm Series</h4>
      </ng-container
    >

    <ng-container *ngIf="item.eventType && item.eventText"
      ><h4>Basic Event Series</h4></ng-container
    >

    <ng-container *ngIf="item.latitude && item.longitude"
      ><h4>Location Event Series</h4>
    </ng-container>

    <ng-container *ngIf="item.type === 'Sleep'"
      ><h4>Sleep Series</h4>
    </ng-container>

    <ng-container *ngIf="item.type === 'SmartRest'"
      ><h4>SmartREST Series</h4>
    </ng-container>

        <button
        class="transparent"
         style="float: right;"
        (click)="delete(item)"
      >
        <i c8yIcon="trash"></i>
      </button>
<!--
    <div
      id="collapseBasic"
      class="collapse"
      [collapse]="!item.active"
      [isAnimated]="true"
    ></div>-->
</ng-template>
<ng-template #addseries><h4><i c8yIcon="plus-circle" style="font-size: large; color: text-primary"></i>&nbsp;Create Series</h4></ng-template>
